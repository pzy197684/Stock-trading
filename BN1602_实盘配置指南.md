# BN1602 币安实盘接入配置指南

## 🚀 概述
本指南将帮助您将BN1602账户接入币安实盘，使用马丁对冲策略进行实盘交易。

## ⚠️ 重要安全提醒
1. **API密钥安全**: 请妥善保管API密钥，绝不要分享给他人
2. **IP白名单**: 强烈建议设置IP白名单限制API访问
3. **权限最小化**: 只开启必要的API权限（期货交易、期货读取）
4. **小资金测试**: 建议先用小资金测试策略效果
5. **资金管理**: 合理控制仓位大小和风险

## 📋 配置步骤

### 1. 获取币安API密钥

1. 登录币安官网 (https://www.binance.com)
2. 进入 "API管理" 页面
3. 创建新的API密钥
4. **重要**: 设置IP白名单（推荐）
5. 开启以下权限：
   - ✅ 期货交易
   - ✅ 读取
   - ❌ 提现（不要开启）
   - ❌ 内网转账（不要开启）

### 2. 更新API配置文件

**文件**: `accounts/BN1602/binance_api.json`

```json
{
  "_comment": "Binance期货API密钥配置 - 实盘账户",
  "_warning": "这是生产环境配置，请确保API密钥安全",
  
  "API_KEY": "YOUR_REAL_BINANCE_API_KEY_HERE",
  "API_SECRET": "YOUR_REAL_BINANCE_API_SECRET_HERE",
  
  "settings": {
    "exchange": "binance",
    "api_type": "futures",
    "testnet": false,
    "base_url": "https://fapi.binance.com",
    "position_mode": "hedge",
    "margin_type": "isolated"
  }
}
```

**请替换**:
- `YOUR_REAL_BINANCE_API_KEY_HERE` → 您的实际API Key
- `YOUR_REAL_BINANCE_API_SECRET_HERE` → 您的实际API Secret

### 3. 更新Profile配置

**文件**: `profiles/BN1602/config.json`

确保以下配置正确：
```json
{
  "api_credentials": {
    "api_key": "YOUR_REAL_BINANCE_API_KEY_HERE",
    "api_secret": "YOUR_REAL_BINANCE_API_SECRET_HERE",
    "extra_params": {
      "testnet": false,
      "position_mode": "hedge"
    }
  }
}
```

### 4. 币安APP设置

1. 打开币安APP，进入合约交易
2. 点击右上角设置图标
3. 找到"持仓模式"选项
4. **重要**: 选择"双向持仓"模式（马丁对冲策略必需）
5. 确认保证金模式设置为"逐仓"

### 5. 验证API连接

运行API检查工具：
```bash
python binance_api_checker.py
```

应该看到：
- ✅ 服务器时间检查通过
- ✅ API权限验证成功
- ✅ 账户信息获取正常
- ✅ 持仓模式为双向持仓
- ✅ ETHUSDT交易对可用

## 🎯 马丁对冲策略配置

### 推荐生产参数（谨慎配置）

**文件**: `profiles/BN1602/martingale_production_config.json`

```json
{
  "trading": {
    "symbol": "ETHUSDT",
    "long": {
      "first_qty": 0.01,        // 首次开仓量（建议从小开始）
      "add_ratio": 2.0,         // 加仓倍数
      "add_interval": 0.02,     // 加仓间隔（2%）
      "max_add_times": 3        // 最大加仓次数
    },
    "short": {
      "first_qty": 0.01,
      "add_ratio": 2.0,
      "add_interval": 0.02,
      "max_add_times": 3
    },
    "hedge": {
      "trigger_loss": 0.05,     // 5%亏损触发对冲
      "equal_eps": 0.01         // 对冲平衡容差
    }
  },
  "risk_control": {
    "max_total_qty": 0.5,       // 最大总仓位
    "max_daily_loss": 100.0,    // 每日最大亏损限制
    "emergency_stop_loss": 0.1  // 紧急止损比例
  }
}
```

### 参数说明

1. **首次开仓量** (`first_qty`): 建议从0.01开始测试
2. **加仓间隔** (`add_interval`): 2%偏离时加仓，可根据波动调整
3. **对冲触发** (`trigger_loss`): 5%亏损时启动对冲锁仓
4. **风控限制**: 严格控制最大仓位和每日亏损

## 🔧 启动实盘交易

### 1. 启动系统
```bash
.\start-simple.bat
```

### 2. 创建交易实例
1. 打开 http://localhost:3000
2. 点击"添加新实例"
3. 选择:
   - 平台: 币安 (binance)
   - 账号: 实盘账号 - 币安1602
   - 策略: 马丁对冲策略V3
   - 交易对: ETHUSDT

### 3. 监控交易
- 查看实时日志
- 监控仓位变化
- 关注盈亏情况
- 及时调整参数

## 📊 关键监控指标

1. **持仓情况**: 多空仓位是否平衡
2. **浮盈浮亏**: 总体盈亏状态
3. **加仓次数**: 是否触发过多加仓
4. **对冲状态**: 是否进入锁仓模式
5. **风控触发**: 是否触发风控保护

## ⚠️ 风险提醒

1. **市场风险**: 极端行情可能导致较大亏损
2. **技术风险**: 网络中断、系统故障等
3. **资金管理**: 不要投入超过承受能力的资金
4. **参数调整**: 根据市场情况及时调整策略参数
5. **止损机制**: 设置合理的止损点位

## 🆘 紧急处理

如遇异常情况：
1. **立即手动平仓**: 在币安APP中手动平掉所有仓位
2. **停止策略**: 在系统界面停止运行实例
3. **检查日志**: 查看系统日志排查问题
4. **联系支持**: 必要时寻求技术支持

## 📝 日常维护

1. **定期检查**: 每日检查策略运行状态
2. **参数优化**: 根据市场表现调整参数
3. **风险评估**: 定期评估总体风险敞口
4. **备份配置**: 备份重要配置文件
5. **系统更新**: 及时更新系统版本

---

**祝您交易顺利！** 🎯

记住：理性投资，风险可控，盈利可期！