# Stock-Trading System é‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é‡æ„æ¦‚è§ˆ

æœ¬æ¬¡é‡æ„æŒ‰ç…§æ‚¨çš„éœ€æ±‚ï¼Œå¯¹åŸæœ‰çš„è‚¡ç¥¨äº¤æ˜“ç³»ç»Ÿè¿›è¡Œäº†å…¨é¢çš„æ¶æ„å‡çº§ï¼Œä¸»è¦å›´ç»•ä»¥ä¸‹5ä¸ªæ ¸å¿ƒç›®æ ‡ï¼š

1. âœ… **æ•´ä½“é€»è¾‘åˆ†åŒ…æ¸…æ™°ï¼Œç»´æŠ¤æ–¹ä¾¿ï¼ŒåŠŸèƒ½æ¨¡å—åŒºåˆ†å½»åº•**
2. âœ… **é€šç”¨æ¨¡å—æ­£å¸¸ä½¿ç”¨ï¼Œè´¦å·/å¹³å°/ç­–ç•¥ç®¡ç†ç‹¬ç«‹å®ä¾‹åŒ–åŒ…è£…**
3. âœ… **æ’ä»¶åŒ–æ‰©å±• - åªéœ€æ·»åŠ JSON/Pythonæ–‡ä»¶å³å¯æ‰©å±•**
4. âœ… **JSONæ ¼å¼æ•°æ®å­˜å‚¨ï¼Œä¾¿äºUIå±•ç¤ºå’Œå‚æ•°è°ƒæ§**
5. âœ… **UIç•Œé¢å¯¹æ¥æ”¯æŒ**

## ğŸ“ æ–°æ¶æ„ç»“æ„

### æ ¸å¿ƒæ¨¡å— (core/)
```
core/
â”œâ”€â”€ domain/          # æ•°æ®æ¨¡å‹å’Œæšä¸¾
â”‚   â”œâ”€â”€ models.py    # AccountState, PositionStateç­‰
â”‚   â””â”€â”€ enums.py     # çŠ¶æ€æšä¸¾
â”œâ”€â”€ platform/        # äº¤æ˜“å¹³å°é€‚é…å™¨
â”‚   â”œâ”€â”€ base.py      # ç»Ÿä¸€æ¥å£ExchangeIf
â”‚   â”œâ”€â”€ binance.py   # Binanceé€‚é…å™¨
â”‚   â”œâ”€â”€ coinw.py     # CoinWé€‚é…å™¨ 
â”‚   â”œâ”€â”€ okx.py       # OKXé€‚é…å™¨
â”‚   â””â”€â”€ plugins/     # å¹³å°æ’ä»¶é…ç½®
â”œâ”€â”€ strategy/        # äº¤æ˜“ç­–ç•¥
â”‚   â”œâ”€â”€ base.py      # ç­–ç•¥åŸºç¡€æŠ½è±¡ç±»
â”‚   â””â”€â”€ plugins/     # ç­–ç•¥æ’ä»¶é…ç½®
â”œâ”€â”€ managers/        # ç®¡ç†å™¨å±‚
â”‚   â”œâ”€â”€ platform_manager.py    # å¹³å°ç®¡ç†å™¨
â”‚   â”œâ”€â”€ strategy_manager_new.py # ç­–ç•¥ç®¡ç†å™¨
â”‚   â””â”€â”€ state_manager.py        # çŠ¶æ€ç®¡ç†å™¨
â”œâ”€â”€ services/        # ä¸šåŠ¡æœåŠ¡å±‚
â”œâ”€â”€ utils/           # å·¥å…·ç±»
â”‚   â””â”€â”€ plugin_loader.py # æ’ä»¶åŠ è½½å™¨
â””â”€â”€ state_store.py   # çŠ¶æ€å­˜å‚¨
```

### åº”ç”¨å±‚ (apps/)
```
apps/
â”œâ”€â”€ api/             # RESTful APIæœåŠ¡
â”‚   â”œâ”€â”€ main.py      # FastAPIæœåŠ¡å™¨
â”‚   â””â”€â”€ requirements.txt
â””â”€â”€ ui/              # å‰ç«¯ç•Œé¢
    â””â”€â”€ src/         # Reactç»„ä»¶
```

## ğŸš€ ä¸»è¦åŠŸèƒ½ç‰¹æ€§

### 1. æ’ä»¶åŒ–æ¶æ„
- **å¹³å°æ’ä»¶**: åœ¨ `core/platform/plugins/` æ·»åŠ JSONé…ç½®æ–‡ä»¶å³å¯æ–°å¢äº¤æ˜“å¹³å°
- **ç­–ç•¥æ’ä»¶**: åœ¨ `core/strategy/plugins/` æ·»åŠ JSONé…ç½®å’ŒPythonå®ç°å³å¯æ–°å¢ç­–ç•¥
- **çƒ­é‡è½½**: æ”¯æŒè¿è¡Œæ—¶é‡æ–°åŠ è½½æ’ä»¶

### 2. å¤šè´¦å·éš”ç¦»ç®¡ç†
- æ¯ä¸ªè´¦å·çš„çŠ¶æ€ã€é…ç½®ã€å¯†é’¥å®Œå…¨ç‹¬ç«‹
- æ”¯æŒåŒä¸€å¹³å°çš„å¤šè´¦å·å¹¶è¡Œè¿è¡Œ
- è´¦å·çº§åˆ«çš„é£é™©æ§åˆ¶å’ŒçŠ¶æ€ç›‘æ§

### 3. ç»Ÿä¸€æ•°æ®æ¥å£
- æ‰€æœ‰å¹³å°é€‚é…å™¨å®ç°ç»Ÿä¸€çš„ `ExchangeIf` æ¥å£
- æ ‡å‡†åŒ–çš„é”™è¯¯å¤„ç†å’Œè¿”å›æ ¼å¼
- ç±»å‹å®‰å…¨çš„æ•°æ®ç»“æ„

### 4. UIå‹å¥½çš„æ•°æ®å­˜å‚¨
- JSONæ ¼å¼çŠ¶æ€å­˜å‚¨ï¼Œä¾¿äºå‰ç«¯è¯»å–
- ç»“æ„åŒ–æ—¥å¿—ï¼Œæ”¯æŒç­›é€‰å’Œåˆ†æ
- å®æ—¶APIæ¥å£ï¼Œæ”¯æŒå‰ç«¯æ•°æ®å±•ç¤º

### 5. ç­–ç•¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ç­–ç•¥å®ä¾‹çš„åˆ›å»ºã€å¯åŠ¨ã€æš‚åœã€åœæ­¢
- å‚æ•°éªŒè¯å’Œè¿è¡Œæ—¶é…ç½®æ›´æ–°
- è¯¦ç»†çš„æ‰§è¡Œç»Ÿè®¡å’Œé”™è¯¯è·Ÿè¸ª

## ğŸ”§ ä½¿ç”¨æŒ‡å—

### å¯åŠ¨äº¤æ˜“ç³»ç»Ÿ
```bash
# åŸºæœ¬å¯åŠ¨
python main.py

# æŒ‡å®šé…ç½®æ–‡ä»¶
python main.py --config config.json

# åªè¿è¡Œç‰¹å®šè´¦å·
python main.py --accounts BN1602 CW1602

# è°ƒè¯•æ¨¡å¼
python main.py --debug

# æ¨¡æ‹Ÿè¿è¡Œï¼ˆä¸å®é™…äº¤æ˜“ï¼‰
python main.py --dry-run
```

### å¯åŠ¨APIæœåŠ¡å™¨
```bash
cd apps/api
pip install -r requirements.txt
python main.py
# APIå°†åœ¨ http://localhost:8000 å¯åŠ¨
```

### æ·»åŠ æ–°å¹³å°ï¼ˆç¤ºä¾‹ï¼šæ·»åŠ Bybitï¼‰
1. åˆ›å»º `core/platform/plugins/bybit.json`:
```json
{
    "name": "bybit",
    "display_name": "Bybit",
    "adapter_class": "core.platform.bybit:BybitExchange",
    "capabilities": {
        "hedge_support": true,
        "position_mode": "both",
        "unit_type": "coin"
    }
}
```

2. å®ç°é€‚é…å™¨ `core/platform/bybit.py`:
```python
from core.platform.base import ExchangeIf

class BybitExchange(ExchangeIf):
    def name(self) -> str:
        return "bybit"
    
    # å®ç°å…¶ä»–æŠ½è±¡æ–¹æ³•...
```

### æ·»åŠ æ–°ç­–ç•¥ï¼ˆç¤ºä¾‹ï¼šæ·»åŠ ç½‘æ ¼ç­–ç•¥ï¼‰
1. åˆ›å»º `core/strategy/plugins/grid_trading.json`:
```json
{
    "name": "grid_trading",
    "display_name": "Grid Trading Strategy", 
    "strategy_class": "core.strategy.grid.strategy:GridTradingStrategy",
    "default_params": {
        "grid_levels": 10,
        "grid_spacing": 0.01
    }
}
```

2. å®ç°ç­–ç•¥ `core/strategy/grid/strategy.py`:
```python
from core.strategy.base import StrategyBase, TradingSignal

class GridTradingStrategy(StrategyBase):
    def get_required_params(self):
        return ["grid_levels", "grid_spacing"]
    
    def generate_signal(self, context):
        # å®ç°ç½‘æ ¼äº¤æ˜“é€»è¾‘
        return TradingSignal(...)
```

## ğŸ“Š APIæ¥å£

### ä¸»è¦APIç«¯ç‚¹
- `GET /api/accounts` - è·å–è´¦å·åˆ—è¡¨
- `GET /api/accounts/{account}/summary` - è´¦å·æ‘˜è¦
- `GET /api/platforms` - å¯ç”¨å¹³å°åˆ—è¡¨
- `POST /api/platforms/{account}/{platform}/create` - åˆ›å»ºå¹³å°å®ä¾‹
- `GET /api/strategies` - å¯ç”¨ç­–ç•¥åˆ—è¡¨
- `POST /api/strategies/{account}/{strategy}/create` - åˆ›å»ºç­–ç•¥å®ä¾‹
- `POST /api/strategies/{account}/{instance}/start` - å¯åŠ¨ç­–ç•¥
- `GET /api/system/status` - ç³»ç»ŸçŠ¶æ€

### APIæ–‡æ¡£
å¯åŠ¨APIæœåŠ¡å™¨åè®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹å®Œæ•´APIæ–‡æ¡£ã€‚

## ğŸ“ˆ æ•°æ®æµç¨‹

1. **åˆå§‹åŒ–é˜¶æ®µ**:
   - åŠ è½½å¹³å°å’Œç­–ç•¥æ’ä»¶
   - åˆ›å»ºè´¦å·å¯¹åº”çš„å¹³å°å®ä¾‹
   - åˆå§‹åŒ–ç­–ç•¥å®ä¾‹

2. **è¿è¡Œé˜¶æ®µ**:
   - ä¸ºæ¯ä¸ªè´¦å·æ„å»ºç­–ç•¥ä¸Šä¸‹æ–‡
   - å¹¶å‘æ‰§è¡Œå„è´¦å·çš„ç­–ç•¥
   - å¤„ç†äº¤æ˜“ä¿¡å·å¹¶æ‰§è¡Œè®¢å•
   - æ›´æ–°è´¦å·çŠ¶æ€

3. **ç›‘æ§é˜¶æ®µ**:
   - å®æ—¶çŠ¶æ€ç›‘æ§
   - APIæ¥å£æä¾›æ•°æ®æŸ¥è¯¢
   - é”™è¯¯å¤„ç†å’Œæ¢å¤

## ğŸ›¡ï¸ å®‰å…¨æ€§å’Œç¨³å®šæ€§

- **è´¦å·éš”ç¦»**: æ¯ä¸ªè´¦å·çš„æ•°æ®å’Œé…ç½®å®Œå…¨ç‹¬ç«‹
- **åŸå­æ“ä½œ**: çŠ¶æ€æ›´æ–°ä½¿ç”¨åŸå­æ–‡ä»¶æ›¿æ¢
- **é”™è¯¯æ¢å¤**: å„å±‚çº§éƒ½æœ‰å¼‚å¸¸å¤„ç†å’Œæ¢å¤æœºåˆ¶
- **æ•°æ®å¤‡ä»½**: è‡ªåŠ¨å¤‡ä»½æŸåçš„çŠ¶æ€æ–‡ä»¶
- **å¥åº·æ£€æŸ¥**: å¹³å°è¿æ¥çŠ¶æ€ç›‘æ§

## ğŸ”„ å‘åå…¼å®¹

- ä¿ç•™äº†åŸæœ‰çš„å‡½æ•°æ¥å£ç”¨äºå‘åå…¼å®¹
- æ—§çš„é…ç½®æ–‡ä»¶å¯ä»¥é€šè¿‡è¿ç§»å·¥å…·è½¬æ¢
- é€æ­¥è¿ç§»ç­–ç•¥ï¼Œæ–°æ—§å¹¶å­˜

## ğŸ“ ä¸‹ä¸€æ­¥å»ºè®®

1. **å®Œå–„ç°æœ‰å¹³å°é€‚é…å™¨**: æ›´æ–°binance.py, coinw.py, okx.pyä»¥å®ç°æ–°çš„ExchangeIfæ¥å£
2. **å®ç°è®¢å•æ‰§è¡ŒæœåŠ¡**: å®Œå–„core/services/ä¸‹çš„ä¸šåŠ¡é€»è¾‘
3. **æ·»åŠ æ›´å¤šç­–ç•¥**: å®ç°æ›´å¤šäº¤æ˜“ç­–ç•¥æ’ä»¶
4. **å®Œå–„æ—¥å¿—ç³»ç»Ÿ**: å®ç°ç»“æ„åŒ–æ—¥å¿—å’Œæ—¥å¿—ç­›é€‰
5. **æ·»åŠ æµ‹è¯•**: ä¸ºæ ¸å¿ƒæ¨¡å—ç¼–å†™å•å…ƒæµ‹è¯•
6. **æ€§èƒ½ä¼˜åŒ–**: æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè¿›è¡Œæ€§èƒ½è°ƒä¼˜

## ğŸ¯ é‡æ„æˆæœ

âœ… **æ¨¡å—åŒ–æ¶æ„**: æ¸…æ™°çš„åˆ†å±‚å’ŒèŒè´£åˆ’åˆ†  
âœ… **æ’ä»¶åŒ–æ‰©å±•**: æ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç å³å¯æ‰©å±•  
âœ… **å¤šè´¦å·æ”¯æŒ**: å®Œå…¨éš”ç¦»çš„å¤šè´¦å·ç®¡ç†  
âœ… **UIå‹å¥½**: JSONæ•°æ®æ ¼å¼å’ŒRESTful API  
âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ç±»å‹æ³¨è§£å’ŒéªŒè¯  
âœ… **é”™è¯¯å¤„ç†**: å¥å£®çš„å¼‚å¸¸å¤„ç†æœºåˆ¶  
âœ… **æ–‡æ¡£å®Œæ•´**: è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’ŒAPIæ–‡æ¡£  

æ‚¨ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªç°ä»£åŒ–ã€å¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„äº¤æ˜“ç³»ç»Ÿæ¶æ„ï¼ğŸ‰